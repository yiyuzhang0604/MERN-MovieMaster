{"ast":null,"code":"var _jsxFileName = \"/Users/yiyuzhang/Downloads/Mingyi-SHI-Yiyu-ZHANG-Proj3-Web-app-master/src/components/DeleteButton.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState } from \"react\";\nimport gql from \"graphql-tag\";\nimport { useMutation } from \"@apollo/react-hooks\";\nimport { Button, Icon, Confirm } from \"semantic-ui-react\";\nimport { FETCH_POSTS_QUERY } from \"../utils/graphql\";\nimport MyPopup from \"../utils/MyPopup\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst DeleteButton = _ref => {\n  _s();\n\n  let {\n    postId,\n    callback,\n    commentId\n  } = _ref;\n  const [confirmOpen, setConfirmOpen] = useState(false);\n  const mutation = commentId ? DELETE_COMMENT_MUTATION : DELETE_POST_MUTATION;\n  const [deleteMutation] = useMutation(mutation, {\n    update(proxy) {\n      setConfirmOpen(false);\n\n      if (!commentId) {\n        const data = proxy.readQuery({\n          query: FETCH_POSTS_QUERY\n        });\n        proxy.writeQuery({\n          query: FETCH_POSTS_QUERY,\n          data: {\n            getPosts: data.getPosts.filter(p => p.id !== postId)\n          }\n        });\n      }\n\n      if (callback) callback();\n    },\n\n    variables: {\n      postId,\n      commentId\n    }\n  });\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(MyPopup, {\n      content: commentId ? \"Delete comment\" : \"Delete post\",\n      children: /*#__PURE__*/_jsxDEV(Button, {\n        as: \"div\",\n        color: \"red\",\n        floated: \"right\",\n        onClick: () => setConfirmOpen(true),\n        children: /*#__PURE__*/_jsxDEV(Icon, {\n          name: \"trash\",\n          style: {\n            margin: 0\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 47,\n          columnNumber: 6\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 41,\n        columnNumber: 5\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 40,\n      columnNumber: 4\n    }, this), /*#__PURE__*/_jsxDEV(Confirm, {\n      open: confirmOpen,\n      onCancel: () => setConfirmOpen(false),\n      onConfirm: deleteMutation\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 50,\n      columnNumber: 4\n    }, this)]\n  }, void 0, true);\n};\n\n_s(DeleteButton, \"7rbGl8W/9mNa0yT3hplrnfFfxGg=\", false, function () {\n  return [useMutation];\n});\n\n_c = DeleteButton;\nconst DELETE_POST_MUTATION = gql`\n\tmutation deletePost($postId: ID!) {\n\t\tdeletePost(postId: $postId)\n\t}\n`;\nconst DELETE_COMMENT_MUTATION = gql`\n\tmutation deleteComment($postId: ID!, $commentId: ID!) {\n\t\tdeleteComment(postId: $postId, commentId: $commentId) {\n\t\t\tid\n\t\t\tcomments {\n\t\t\t\tid\n\t\t\t\tusername\n\t\t\t\tcreatedAt\n\t\t\t\tbody\n\t\t\t}\n\t\t\tcommentCount\n\t\t}\n\t}\n`;\nexport default DeleteButton;\n\nvar _c;\n\n$RefreshReg$(_c, \"DeleteButton\");","map":{"version":3,"sources":["/Users/yiyuzhang/Downloads/Mingyi-SHI-Yiyu-ZHANG-Proj3-Web-app-master/src/components/DeleteButton.js"],"names":["React","useState","gql","useMutation","Button","Icon","Confirm","FETCH_POSTS_QUERY","MyPopup","DeleteButton","postId","callback","commentId","confirmOpen","setConfirmOpen","mutation","DELETE_COMMENT_MUTATION","DELETE_POST_MUTATION","deleteMutation","update","proxy","data","readQuery","query","writeQuery","getPosts","filter","p","id","variables","margin"],"mappings":";;;AAAA,OAAOA,KAAP,IAAgBC,QAAhB,QAAgC,OAAhC;AACA,OAAOC,GAAP,MAAgB,aAAhB;AACA,SAASC,WAAT,QAA4B,qBAA5B;AACA,SAASC,MAAT,EAAiBC,IAAjB,EAAuBC,OAAvB,QAAsC,mBAAtC;AAEA,SAASC,iBAAT,QAAkC,kBAAlC;AACA,OAAOC,OAAP,MAAoB,kBAApB;;;;AAEA,MAAMC,YAAY,GAAG,QAAqC;AAAA;;AAAA,MAApC;AAAEC,IAAAA,MAAF;AAAUC,IAAAA,QAAV;AAAoBC,IAAAA;AAApB,GAAoC;AACzD,QAAM,CAACC,WAAD,EAAcC,cAAd,IAAgCb,QAAQ,CAAC,KAAD,CAA9C;AAEA,QAAMc,QAAQ,GAAGH,SAAS,GAAGI,uBAAH,GAA6BC,oBAAvD;AAEA,QAAM,CAACC,cAAD,IAAmBf,WAAW,CAACY,QAAD,EAAW;AAC9CI,IAAAA,MAAM,CAACC,KAAD,EAAQ;AACbN,MAAAA,cAAc,CAAC,KAAD,CAAd;;AAEA,UAAI,CAACF,SAAL,EAAgB;AACf,cAAMS,IAAI,GAAGD,KAAK,CAACE,SAAN,CAAgB;AAC5BC,UAAAA,KAAK,EAAEhB;AADqB,SAAhB,CAAb;AAGAa,QAAAA,KAAK,CAACI,UAAN,CAAiB;AAChBD,UAAAA,KAAK,EAAEhB,iBADS;AAEhBc,UAAAA,IAAI,EAAE;AACLI,YAAAA,QAAQ,EAAEJ,IAAI,CAACI,QAAL,CAAcC,MAAd,CAAsBC,CAAD,IAAOA,CAAC,CAACC,EAAF,KAASlB,MAArC;AADL;AAFU,SAAjB;AAMA;;AAED,UAAIC,QAAJ,EAAcA,QAAQ;AACtB,KAjB6C;;AAkB9CkB,IAAAA,SAAS,EAAE;AACVnB,MAAAA,MADU;AAEVE,MAAAA;AAFU;AAlBmC,GAAX,CAApC;AAwBA,sBACC;AAAA,4BACC,QAAC,OAAD;AAAS,MAAA,OAAO,EAAEA,SAAS,GAAG,gBAAH,GAAsB,aAAjD;AAAA,6BACC,QAAC,MAAD;AACC,QAAA,EAAE,EAAC,KADJ;AAEC,QAAA,KAAK,EAAC,KAFP;AAGC,QAAA,OAAO,EAAC,OAHT;AAIC,QAAA,OAAO,EAAE,MAAME,cAAc,CAAC,IAAD,CAJ9B;AAAA,+BAMC,QAAC,IAAD;AAAM,UAAA,IAAI,EAAC,OAAX;AAAmB,UAAA,KAAK,EAAE;AAAEgB,YAAAA,MAAM,EAAE;AAAV;AAA1B;AAAA;AAAA;AAAA;AAAA;AAND;AAAA;AAAA;AAAA;AAAA;AADD;AAAA;AAAA;AAAA;AAAA,YADD,eAWC,QAAC,OAAD;AACC,MAAA,IAAI,EAAEjB,WADP;AAEC,MAAA,QAAQ,EAAE,MAAMC,cAAc,CAAC,KAAD,CAF/B;AAGC,MAAA,SAAS,EAAEI;AAHZ;AAAA;AAAA;AAAA;AAAA,YAXD;AAAA,kBADD;AAmBA,CAhDD;;GAAMT,Y;UAKoBN,W;;;KALpBM,Y;AAkDN,MAAMQ,oBAAoB,GAAGf,GAAI;AACjC;AACA;AACA;AACA,CAJA;AAMA,MAAMc,uBAAuB,GAAGd,GAAI;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAbA;AAeA,eAAeO,YAAf","sourcesContent":["import React, { useState } from \"react\";\nimport gql from \"graphql-tag\";\nimport { useMutation } from \"@apollo/react-hooks\";\nimport { Button, Icon, Confirm } from \"semantic-ui-react\";\n\nimport { FETCH_POSTS_QUERY } from \"../utils/graphql\";\nimport MyPopup from \"../utils/MyPopup\";\n\nconst DeleteButton = ({ postId, callback, commentId }) => {\n\tconst [confirmOpen, setConfirmOpen] = useState(false);\n\n\tconst mutation = commentId ? DELETE_COMMENT_MUTATION : DELETE_POST_MUTATION;\n\n\tconst [deleteMutation] = useMutation(mutation, {\n\t\tupdate(proxy) {\n\t\t\tsetConfirmOpen(false);\n\n\t\t\tif (!commentId) {\n\t\t\t\tconst data = proxy.readQuery({\n\t\t\t\t\tquery: FETCH_POSTS_QUERY,\n\t\t\t\t});\n\t\t\t\tproxy.writeQuery({\n\t\t\t\t\tquery: FETCH_POSTS_QUERY,\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tgetPosts: data.getPosts.filter((p) => p.id !== postId),\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (callback) callback();\n\t\t},\n\t\tvariables: {\n\t\t\tpostId,\n\t\t\tcommentId,\n\t\t},\n\t});\n\n\treturn (\n\t\t<>\n\t\t\t<MyPopup content={commentId ? \"Delete comment\" : \"Delete post\"}>\n\t\t\t\t<Button\n\t\t\t\t\tas='div'\n\t\t\t\t\tcolor='red'\n\t\t\t\t\tfloated='right'\n\t\t\t\t\tonClick={() => setConfirmOpen(true)}\n\t\t\t\t>\n\t\t\t\t\t<Icon name='trash' style={{ margin: 0 }} />\n\t\t\t\t</Button>\n\t\t\t</MyPopup>\n\t\t\t<Confirm\n\t\t\t\topen={confirmOpen}\n\t\t\t\tonCancel={() => setConfirmOpen(false)}\n\t\t\t\tonConfirm={deleteMutation}\n\t\t\t/>\n\t\t</>\n\t);\n};\n\nconst DELETE_POST_MUTATION = gql`\n\tmutation deletePost($postId: ID!) {\n\t\tdeletePost(postId: $postId)\n\t}\n`;\n\nconst DELETE_COMMENT_MUTATION = gql`\n\tmutation deleteComment($postId: ID!, $commentId: ID!) {\n\t\tdeleteComment(postId: $postId, commentId: $commentId) {\n\t\t\tid\n\t\t\tcomments {\n\t\t\t\tid\n\t\t\t\tusername\n\t\t\t\tcreatedAt\n\t\t\t\tbody\n\t\t\t}\n\t\t\tcommentCount\n\t\t}\n\t}\n`;\n\nexport default DeleteButton;\n"]},"metadata":{},"sourceType":"module"}